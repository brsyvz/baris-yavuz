{{ 'by-product-grid.css' | asset_url | preload_tag: as: 'style' }}
{{ 'by-product-grid.css' | asset_url | stylesheet_tag }}

{% liquid
  assign loading = 'eager'
  assign fetchpriority = 'high'

  if section.index > 1
    assign loading = 'lazy'
    assign fetchpriority = 'low'
  endif
%}

{% liquid
  assign ss = section.settings
  assign padding_top_mobile = ss.padding_top_mobile
  assign padding_bottom_mobile = ss.padding_bottom_mobile
  assign padding_top_desktop = ss.padding_top_desktop
  assign padding_bottom_desktop = ss.padding_bottom_desktop
%}

{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ padding_top_mobile }}px;
    padding-bottom: {{ padding_bottom_mobile }}px;
  }
  @media (min-width: 960px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ padding_top_desktop }}px;
      padding-bottom: {{ padding_bottom_desktop }}px;
    }
  }
{%- endstyle -%}

<div class="section-{{ section.id }}-padding color-{{ section.settings.color_scheme }} resetter custom-page-width">
  <h2>
    {% if ss.title %}
      {{ ss.title }}
    {% endif %}
  </h2>
  <div class="product-grid-wrapper">
    {%- for block in section.blocks -%}
      {% liquid
        assign bs = block.settings
        assign product = bs.product
        assign image = bs.image
        assign focal_x = image.presentation.focal_point.x 
        assign focal_y = image.presentation.focal_point.y
        if focal_x and focal_y
        assign focal_x = focal_x | append: '%'
        assign focal_y = focal_y | append: '%'
      else
        assign focal_x = '50%'
        assign focal_y = '20%' 
      endif
      %}
      <div class="product-grid">
        <div class="image-wrapper">
          {{ image | image_url: width: 433, height: 444 | image_tag: loading: loading, fetchpriority: fetchpriority, alt: image.alt, class: "product-image" }}
          <button
            data-product-id="{{ product.id }}"
            class="modal-toggle"
            role="button"
            style="position: absolute; top: {{ focal_y }}; left: {{ focal_x }}; transform: translate(-50%, -50%);">
            {{- 'by-icon-plus.svg' | inline_asset_content -}}
          </button>
        </div>

      </div>
    {% endfor %}
  </div>
</div>

{% render 'by-modal', products_data: section.blocks %}

{% schema %}
  {
    "name": "t:sections.product-grid.name",
    "tag": "section",
    "class": "product-grid-section",
    "disabled_on": {
      "groups": ["header", "footer"]
    },
    "settings": [
      {
        "type": "inline_richtext",
        "id": "title",
        "label": "t:sections.product-grid.settings.title.label",
        "default": "Tisso vison in the wild"
      },
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "t:sections.all.colors.label",
        "default": "scheme-1"
      },
      {
        "type": "range",
        "id": "padding_top_mobile",
        "min": 0,
        "max": 120,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_top_mobile",
        "default": 0
      },
      {
        "type": "range",
        "id": "padding_bottom_mobile",
        "min": 0,
        "max": 120,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_bottom_mobile",
        "default": 0
      }, {
        "type": "range",
        "id": "padding_top_desktop",
        "min": 0,
        "max": 120,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_top_desktop",
        "default": 0
      }, {
        "type": "range",
        "id": "padding_bottom_desktop",
        "min": 0,
        "max": 120,
        "step": 2,
        "unit": "px",
        "label": "t:sections.all.padding.padding_bottom_desktop",
        "default": 0
      }
    ],
    "blocks": [
      {
        "type": "t:sections.product-grid.blocks.type",
        "name": "t:sections.product-grid.blocks.name",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "t:sections.product-grid.blocks.settings.image.label",
            "info": "for focal point"
          }, {
            "type": "product",
            "id": "product",
            "label": "t:sections.product-grid.blocks.settings.product.label"
          }
        ]
      }
    ],
 "presets": [
  {
    "name": "t:sections.product-grid.presets.name",
    "category": "t:sections.product-grid.presets.category",
    "settings": {
          "color_scheme": "scheme-1",
          "padding_top_mobile": 40,
          "padding_bottom_mobile": 0,
          "padding_top_desktop": 90,
          "padding_bottom_desktop": 0
        },
    "blocks": [
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/black-bag-over-the-shoulder_925x_4cae5708-5e9e-4e7e-96ec-9649f0c20cd8.jpg",
          "product": "black-leather-bag"
        }
      },
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/man-adjusts-blue-tuxedo-bowtie_925x_55a49e12-d54b-488e-b7a0-ea4c201eb01f.jpg",
          "product": "blue-silk-tuxedo"
        }
      },
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/red-plaid-shirt_925x_70e9e5a8-8fc5-4d60-9a9a-cc2e0dd57cc9.jpg",
          "product": "chequered-red-shirt"
        }
      },
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/leather-jacket-and-tea_925x_2490cde1-7e61-4151-9a65-de8a763bc701.jpg",
          "product": "classic-leather-jacket"
        }
      },
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/casual-fashion-woman_925x_56b56608-f207-45c1-b677-bb5aa26c1c7a.jpg",
          "product": "classic-varsity-top"
        }
      },
      {
        "type": "t:sections.product-grid.blocks.type",
        "settings": {
          "image": "shopify://shop_images/young-female-models-denim_925x_44c2cf9e-4030-4347-9d4a-f0e4a1479b4a.jpg",
          "product": "dark-denim-top"
        }
      }
    ]
  }
]

  }
{% endschema %}